@using System.Collections.Specialized
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using Shared.Application.Utility
@model Blogs1.Application.Contract.BlogCategoryService.Command.CreateBlogCategory

<!-- Modal -->


<form action="/Admin/Categories/Create" method="post" class="modal-dialog" role="document" enctype="multipart/form-data">
	<div class="modal-content">
		<div class="modal-header">
			<h5 class="modal-title" id="createBlogCategoryModal">دسته بندی جدید</h5>

		</div>
		<div class="modal-body">
			<div class="form-group">
				@Html.EditorFor(x=> x.Title)
				@Html.EditorFor(x=> x.ImageFile)
				@Html.EditorFor(x=> x.ImageAlt)
				@Html.EditorFor(x=> x.Slug)
				<br><br>
				<img id="img_preview" src="@Directories.GetBlogCategoryImageFullPath(@Model?.ImageName ?? null,100)" height="100" width="100" alt="user-avatar" />
				<br><br>

			</div>
			
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">انصراف</button>
			<button type="submit" class="btn btn-primary">افزودن</button>
		</div>
	</div>
</form>

<script>

	//event listener for input type file for preventing choosing any file except image file before user submit the form
	document.getElementById('file_input').addEventListener('change', function (event) {
		const file = event.target.files[0];
		if (validateImageFile(file)) {
			if (file && file.type.startsWith('image/')) {
				const reader = new FileReader();
				reader.onload = function (e) {
					const img = document.getElementById('img_preview');
					img.src = e.target.result;
					img.style.display = 'block';
				};
				reader.readAsDataURL(file);
			}
		}

	});


	function validateImageFile(file) {
		const allowedImageTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/bmp', 'image/webp'];
		if (file && allowedImageTypes.includes(file.type)) {
			return true;
		} else {
			ErrorAlert('تصویر نامعتبر!', 'لطفا تصویر معتبر که پسوند های jpeg,png,bmp,webp داشته باشد انتخاب کنید');
			$("#file_input").val('');
			return false;
		}
	}

		

</script>



