@using Shared.Application.Utility
@model Users1.Application.Contract.UserService.Command.EditUserByAdmin

@{
	ViewData["Title"]= "ویرایش کاربر";
	
}
<div style="margin-right: 200px; margin-left: 200px; " >

	<br><br>
<form class=" mt-3" method="post" href="/Admin/Home/EditUser" enctype="multipart/form-data">
	
	@Html.HiddenFor(x=> x.Id)
	@Html.HiddenFor(x=> x.AvatarName)
	@Html.EditorFor(x=> x.FullName)
	@Html.EditorFor(x=> x.Mobile)
	@Html.EditorFor(x=> x.Email)
	@Html.EditorFor(x=> x.UserGender)
	<br><br>
	<img id="user_avatar" src="@Directories.GetUserAvatarFullPath(@Model.AvatarName,100)" height="100" width="100" alt="user-avatar"/>
	<br><br>
	
	@Html.EditorFor(x=> x.AvatarFile)
	@Html.EditorFor(x=> x.biography)
	
	@if (@Model.IsBanned)
	{
		<a class="btn btn-danger  mr-1" onclick="changeBan('/Admin/Home/ChangeUserBan/@Model.Id')">بــــن کردن</a>
	}
	else
	{
		<a class="btn btn-primary mr-1" onclick="changeBan('/Admin/Home/ChangeUserBan/@Model.Id')">از بن در آوردن</a>
	}
	
	@if (Model.IsActive)
	{
		<a class="btn btn-danger mr-1" onclick="changeActivation('/Admin/Home/ChangeUserActivation/@Model.Id')"> غیر فعال کردن</a>
	}
	else
	{
		<a class="btn btn-primary mr-1" onclick="changeActivation('/Admin/Home/ChangeUserActivation/@Model.Id')">  فعال کردن</a>
	}
	<br><br>
	<button type="submit" onclick="return confirmSubmission()" class="btn btn-success mr-1 ">ثبت ویرایش</button>
	<a class="btn btn-danger m-3" href="../">انصراف</a>
</form>
</div>
@section Scripts
{
	
	<script type="text/javascript">
		function confirmSubmission() {
			return confirm("آیا مطمعنید؟");
		}
	</script>

	<script>
		function changeActivation(url, errorTitle, errorText) {
			if (errorTitle == null || errorTitle == "undefined") {
				errorTitle = "عملیات ناموفق";
			}
			if (errorText == null || errorText == "undefined") {
				errorText = "";
			}
			Swal.fire({
				title: "هشدار !!",
				text: "آیا از انجام عملیات اطمینان دارید ؟",
				icon: "warning",
				confirmButtonText: "بله",
				showCancelButton: true,
				cancelButtonText: "خیر",
				preConfirm: () => {
					$.ajax({
						url: url,
						type: "get",
						beforeSend: function () {
							$(".loading").show();
						},
						complete: function () {
							$(".loading").hide();
						},
						error: function (data) {
							ErrorAlert("مشکلی در اعملیات رخ داده", "لطفا در زمان دیگری امتحان کنید");
						}
					}).done(function (result) {
						{
							if (result.success) {
								Success(result.title, result.message);
							} else {
								ErrorAlert(result.title, result.message);
							}

							setTimeout(function (parameters) {
									location.reload();
								},
								2000);
						}
					});


				}
			});
		}
	</script>
	
	<script>
		function changeBan(url, errorTitle, errorText) {
			if (errorTitle == null || errorTitle == "undefined") {
				errorTitle = "عملیات ناموفق";
			}
			if (errorText == null || errorText == "undefined") {
				errorText = "";
			}
			Swal.fire({
				title: "هشدار !!",
				text: "آیا از انجام عملیات اطمینان دارید ؟",
				icon: "warning",
				confirmButtonText: "بله",
				showCancelButton: true,
				cancelButtonText: "خیر",
				preConfirm: () => {
					$.ajax({
						url: url,
						type: "get",
						beforeSend: function () {
							$(".loading").show();
						},
						complete: function () {
							$(".loading").hide();
						},
						error: function (data) {
							ErrorAlert("مشکلی در اعملیات رخ داده", "لطفا در زمان دیگری امتحان کنید");
						}
					}).done(function (result) {
						{
							if (result.success) {
								Success(result.title, result.message);
							} else {
								ErrorAlert(result.title, result.message);
							}

							setTimeout(function (parameters) {
									location.reload();
								},
								2000);
						}
					});


				}
			});
		}
	</script>

}
